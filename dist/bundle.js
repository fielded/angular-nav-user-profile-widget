!function(n){"use strict";function e(n,e){return e={exports:{}},n(e,e.exports),e.exports}n="default"in n?n.default:n;var i='<span\n  uib-dropdown\n  auto-close="outsideClick"\n>\n  <a\n    id="user-profile-widget-dropdown"\n    class="clickable"\n    uib-dropdown-toggle\n  >\n    <img\n      class="img-circle"\n      alt="User profile picture"\n      ng-src="{{$ctrl.photo}}"\n      fb-src="assets/images/user.png"\n      width="50"\n      height="50"\n    >\n    <i\n      class="fa fa-caret-down"\n      aria-hidden="true"\n      title="Toggle dropdown menu"\n    ></i>\n  </a>\n  <ul\n    class="dropdown-menu user-profile-widget-popover"\n    uib-dropdown-menu\n    aria-labelledby="user-profile-widget-dropdown"\n  >\n    <li>\n      <div class="row profile">\n        <div class="col-sm-4">\n          <p class="text-center">\n            <form name="profilePicture">\n              <profile-picture\n                session="$ctrl.session"\n              ></profile-picture>\n            </form>\n          </p>\n        </div>\n        <div class="col-sm-8">\n          <p>\n            <strong\n              ng-bind="::$ctrl.session.fullName"\n            ></strong>\n          </p>\n          <p\n            ng-bind="::$ctrl.session.email"\n          ></p>\n          <div ng-messages="profilePicture.$error" class="text-danger">\n            <div ng-messages-include="profile-picture-error-messages.html"></div>\n          </div>\n        </div>\n      </div>\n    </li>\n    <li>\n      <div class="well clearfix">\n        <a\n          class="btn btn-default pull-right clickable"\n          ng-click="$ctrl.logout()"\n        >Logout</a>\n      </div>\n    </li>\n  </ul>\n</span>\n',s=e(function(n,e){e.getPhoto=function(n,e,i){return"https://s3-"+i.s3upload.region+".amazonaws.com/"+i.s3upload.resizedBucket+"/"+i.s3upload.folder+"resized/"+e+"/"+n+".jpg"}}),o=s.getPhoto,t=function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")},a=function(){function n(n,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(n,s.key,s)}}return function(e,i,s){return i&&n(e.prototype,i),s&&n(e,s),e}}(),l=function(){function n(e,i){t(this,n),this.photo=o(this.session.userName,"xs",e),this.loginService=i}return a(n,[{key:"setPhoto",value:function(n){this.photo=n}},{key:"logout",value:function(){var n=this;return this.loginService.logout().then(function(){return n.loginService.navLogout()})}}]),n}();l.$inject=["config","loginService"];var r={template:i,bindings:{session:"<"},controller:l},p='<span ng-message="totalsize">Total size of files is too big.</span>\n<span ng-message="totalfiles">Total number of files is more than allowed, please delete some of them.</span>\n<span ng-message="required">At least one file has to be uploaded.</span>\n<span ng-message="extension">Could not upload that file. Valid extensions are ".jpg".</span>\n<span ng-message="filesize">One of the files exceed allowed size.</span>\n<span ng-message="policy_content">URL does not provide an S3 policy.</span>\n<span ng-message="policy_get">Cannot retreive S3 policy over URL provided.</span>\n<span ng-message="policy_set">No policy parameter found.</span>\n<span ng-message="upload">Something happened during upload.</span>\n',c=function(n){n.put("profile-picture-error-messages.html",p)};c.$inject=["$templateCache"];var u='<div\n  ng-if="$ctrl.uploading"\n  class="photo"\n>\n  <i\n    class="fa fa-spinner fa-spin fa-3x"\n  ></i>\n</div>\n\n<div\n  class="photo"\n  ng-mouseover="$ctrl.hideCaption = false"\n  ng-mouseleave="$ctrl.hideCaption = true"\n  ng-if="!$ctrl.uploading"\n>\n  <div\n    ng-class="{\n      \'hidden\': $ctrl.hideCaption,\n      \'caption\': !$ctrl.hideCaption\n    }"\n    s3\n    options="$ctrl.s3Options"\n    ng-model="$ctrl.files"\n  >\n    <span>Change</span>\n  </div>\n  <img\n    class="img-circle clickable"\n    alt="User profile picture"\n    ng-src="{{$ctrl.photo}}"\n    fb-src="assets/images/user.png"\n    width="80"\n    height="80"\n  >\n</div>\n',d=function n(e,i,s){var a=this;t(this,n),this.hideCaption=!0,this.files=[],this.photo=o(this.session.userName,"s",i),this.s3Options={extensions:["jpg"],bucket:i.s3upload.bucket,folder:i.s3upload.folder,filename:this.session.userName,filesize:5242880,region:i.s3upload.region,immediate:!0,on_upload_state_change:function(n){a.uploading=n},on_success:function(n,i){if(a.files=[],i){var s=new e.FileReader;s.onload=function(){s.result&&(a.photo=s.result,a.userProfileWidget.setPhoto(s.result))},s.readAsDataURL(i)}},on_error:function(){a.files=[],a.uploading=!1,s.error("upload-failed")},limit:1,replace:!0,policy:i.s3upload.policy}};d.$inject=["$window","config","toastService"];var g={template:u,require:{userProfileWidget:"^"},bindings:{session:"<"},controller:d};n.module("angularNavUserProfileWidget",["ngMessages","fallback.src","angular.aws.s3"]).run(c).component("userProfileWidget",r).component("profilePicture",g)}(angular);